service: transcribe-audio

custom:
  stage: ${env:SLS_STAGE, opt:stage, self:provider.stage, 'dev'}

provider:
  name: aws
  runtime: go1.x
  profile: ${file(../../../config/config.${self:custom.stage}.yml):profile}

  versionFunctions: false
  region: us-east-1
  memorySize: 1024
  timeout: 30
  environment: ${file(../../../config/config.${self:custom.stage}.yml):environment}

  iamRoleStatements:
    - Effect: 'Allow'
      Action:
        - 'lambda:InvokeFunction'
      Resource: "*"

    - Effect: 'Allow'
      Action: 
        - ssm:GetParameters
        - ssm:GetParametersByPath
      Resource: "*"

    - Effect: Allow
      Action:
        - "s3:*"
      Resource: "*"


package:
 individually: ${file(../../../config/config.${self:custom.stage}.yml):packageIndidually}
 exclude:
   - ../../../**
 include:
   - ../../../bin/**

functions:

  hello:
    handler: bin/hello
    events:
      - http:
          path: hello
          method: get
          cors: true

  world:
    handler: bin/world
    events:
      - http:
          path: world
          method: get
